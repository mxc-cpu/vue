import{l as G,G as B,a as D}from"./StoreLogin-90de31fe.js";import{P as N,b as V}from"./dynamicsApi-00344969.js";import{q as A,a as k,r as v,h as j,i as q,b as x,o as n,j as c,w as l,I as E,f as h,d as z,m as L,t as S,e as u,F as P,u as d}from"./index-e5993185.js";const M={key:0},R=["src"],H={class:"has-text-centered"},J={class:"level py-6"},K={key:0},Q=["src"],T={class:"has-text-centered"},W={class:"level py-6"},ea={__name:"FocusAndFan",setup(X){const g=A();G();const I=k(`/focus/${g.params.id}`),_=v({arr:[]}),b=v({arr:[]});var C=k(1),p=v({pageIndex:1,pageSize:36}),U=k(1),i=v({pageIndex:1,pageSize:36});const F=async(s=0)=>{s!=0&&(p.pageIndex=s);const r=v({Id:g.params.id,pageIndex:p.pageIndex,pageSize:p.pageSize});let e={arr:[]};N(r).then(async t=>{if(b.arr.splice(0),t.data.success==!0){e.arr=t.data.data.dataList,C.value=parseInt(t.data.data.recordCount/p.pageSize)+(t.data.data.recordCount%p.pageSize>0?1:0);for(let o in e.arr){const[m,f]=await Promise.all([B(e.arr[o].value),D(e.arr[o].value)]);let y={userId:e.arr[o].value,avatar:m.data.data,name:f.data};b.arr.push(y)}}else _.arr=push(t.data.data)})},w=async(s=0)=>{s!=0&&(i.pageIndex=s);const r=v({Id:g.params.id,pageIndex:i.pageIndex,pageSize:i.pageSize});let e={arr:[]};V(r).then(async t=>{if(_.arr.splice(0),console.log("清空",_.arr),t.data.success==!0){e.arr=t.data.data.dataList,U.value=parseInt(t.data.data.recordCount/i.pageSize)+(t.data.data.recordCount%i.pageSize>0?1:0);for(let o in e.arr){const[m,f]=await Promise.all([B(e.arr[o].value),D(e.arr[o].value)]);let y={userId:e.arr[o].value,avatar:m.data.data,name:f.data};_.arr.push(y)}}else _.arr=push(t.data.data)})},$=s=>{E.push(s)};return j(()=>{w(),F()}),q(()=>{I.value=g.path,console.log("route",I.value)}),(s,r)=>{const e=x("router-link"),t=x("n-gi"),o=x("n-grid"),m=x("n-pagination"),f=x("n-tab-pane"),y=x("n-tabs");return n(),c(y,{animated:"true",type:"card","tab-style":"min-width: 80px;",value:I.value,"onUpdate:value":[r[2]||(r[2]=a=>I.value=a),$]},{default:l(()=>[h(f,{tab:"我关注的人",name:`/focus/${d(g).params.id}`},{default:l(()=>[(n(),c(o,{key:s.index,"x-gap":"20","y-gap":"2",cols:9},{default:l(()=>[(n(!0),z(P,null,L(b.arr,(a,O)=>(n(),c(t,null,{default:l(()=>[a=="没有关注"?(n(),z("p",M,S(a),1)):(n(),c(e,{key:1,to:`/DynamicsUser/${a.userId}`},{default:l(()=>[u("div",null,[u("img",{class:"image is- 1by1",src:a.avatar},null,8,R),u("p",H,S(a.name),1)])]),_:2},1032,["to"]))]),_:2},1024))),256))]),_:1})),u("div",J,[h(m,{class:"level-item has-text-centered",page:d(p).pageIndex,"onUpdate:page":[r[0]||(r[0]=a=>d(p).pageIndex=a),F],"page-size":d(p).pageSize,"page-count":d(C)},null,8,["page","page-size","page-count"])])]),_:1},8,["name"]),h(f,{tab:"我的粉丝",name:`/fan/${d(g).params.id}`},{default:l(()=>[(n(),c(o,{key:s.index,"x-gap":"20","y-gap":"2",cols:9},{default:l(()=>[(n(!0),z(P,null,L(_.arr,(a,O)=>(n(),c(t,null,{default:l(()=>[a=="没有粉丝"?(n(),z("p",K,S(a),1)):(n(),c(e,{key:1,to:`/DynamicsUser/${a.userId}`},{default:l(()=>[u("div",null,[u("img",{class:"image is- 1by1",src:a.avatar},null,8,Q),u("p",T,S(a.name),1)])]),_:2},1032,["to"]))]),_:2},1024))),256))]),_:1})),u("div",W,[h(m,{class:"level-item has-text-centered",page:d(i).pageIndex,"onUpdate:page":[r[1]||(r[1]=a=>d(i).pageIndex=a),w],"page-size":d(i).pageSize,"page-count":d(U)},null,8,["page","page-size","page-count"])])]),_:1},8,["name"])]),_:1},8,["value"])}}};export{ea as default};
